package_name: ZZ_EvilScheme
install_command: sbreload || killall backboardd

ZZ_EvilScheme:
    type: tweak
    logos_files:
        - $eval("find . -name '*.xm'")
    targetios: 13.0
    archs:
        - arm64
        - arm64e
    frameworks:
        - UserActivity
        - EvilKit
EvilKit:
    dir: EvilKit
    type: bundle
    install_location: "/Library/Frameworks/EvilKit.framework/"
    files:
        - $eval("find ./EvilKit/src -name '*.m'")
    archs:
        - arm64
        - arm64e
    stage:
        - mkdir -p .dragon/_/Library/Frameworks/EvilKit.framework/Headers
        - cp src/*.h .dragon/_/Library/Frameworks/EvilKit.framework/Headers
EvilSchemePrefs:
    dir: Prefs
    type: bundle
    targetios: 13.0
    files:
        - $eval("find ./Prefs/src ./Prefs/L0Prefs -name '*.m'")
    c_header_search_dirs:
        - ./Prefs/L0Prefs
        - ./Prefs/src
    archs:
        - arm64
        - arm64e
    frameworks:
        - Preferences
        - EvilKit
    stage:
        - mkdir -p .dragon/_/Library/PreferenceLoader/Preferences/
        - cp entry.plist .dragon/_/Library/PreferenceLoader/Preferences/$name.plist
